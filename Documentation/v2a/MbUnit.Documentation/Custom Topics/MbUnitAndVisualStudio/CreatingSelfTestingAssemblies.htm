<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" >
<head>
    <title>Creating Self-testing Assemblies</title>
   <link href="../Styles/MbUnitDocs.css" rel="stylesheet" type="text/css" />
</head>
<body>
   <h1>Creating Self-testing Assemblies</h1>
   <p>Test assemblies can be turned into executables which run all their tests on their own and generate an HTML report with very little effort. This comes in handy if you don&#8217;t have a test runner to hand and it won&#8217;t hinder testing if you do. You simply pass the .exe file to the GUI or console runner instead of the .dll you were passing previously.</p>
   <ol>
      <li>Add an empty code file to your test project.</li>
      <li>Use the <a href="MbUnitSnippets.htm">autorunner code snippet</a> to add the following code to the file. Change the code namespace as required.<br />
<pre class="csharpcode">
<span class="kwrd">using</span> MbUnit.Core;

<span class="kwrd">namespace</span> MbUnit.Tests
{
   <span class="kwrd">static</span> <span class="kwrd">class</span> Program
   {
      <span class="kwrd">public</span> <span class="kwrd">static</span> <span class="kwrd">void</span> Main(<span class="kwrd">string</span>[] args)
      {
         <span class="kwrd">using</span> (AutoRunner auto = <span class="kwrd">new</span> AutoRunner())
         {
            auto.Run();
            auto.ReportToHtml();
         }
      }
   }
}</pre>
      </li>
      <li>Open the test project&#8217;s properties dialog. In the Application tab, change the <em>Output Type</em> to &#8220;Console Application&#8221; and <em>Startup object</em> to the class you just created in step 2.<br /><a href="../Images/SelfTestAssemblies[1].png" target="_blank" title="Display this image at full size">
            <img src="../Images/SelfTestAssemblies[1]Thumbnail.png" alt="Visual Studio Project Properties dialog set to create an executable self-test runner. Click this thumbnail image to show full size image" /></a><br /><br /></li>
      <li>Build your solution and press F5 to test.</li>
   </ol>
</body>
</html>
