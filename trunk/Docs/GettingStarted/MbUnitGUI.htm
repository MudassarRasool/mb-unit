<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
   <title>Using The MbUnit GUI Runner</title>
   <link href="../Styles/MbUnitDocs.css" rel="stylesheet" type="text/css" />
</head>
<body>
   <h1>
      Using The MbUnit GUI Runner</h1>
   <p>
      MbUnit proffers two applications for running tests against your code. The console
      runner discussed <a href="MbUnitConsoleRunner.htm">on this page</a> and the windows-based
      application discussed here. You'll find them both in the MbUnit installation directory;
      c:\program files\mbunit by default. If you intend to use the GUI runner a lot, it
      might not be a bad idea to create a shortcut to it on your desktop or pin it to
      your start menu as it is not added to your start menu during installation.</p>
   <p>
      Open the GUI by double-clicking on the executable or <a href="#cmdprompt">by running
         it from the command prompt</a>. You&#8217;ll see the following.</p>
   <p>
      <a href="../Images/GUIRunner[1].png" target="_blank" title="Display this image at full size">
         <img src="../Images/GUIRunner[1]Thumbnail.png" alt="MbUnit GUI runner when first loaded. Click this thumbnail image to show full size image" /></a></p>
   <p>
      The GUI runner opens by default with no test assemblies loaded. Typically, you&#8217;ll
      want to use it in the following manner.</p>
   <ol>
      <li>Load test assemblies into the runner either directly with the <em>Assemblies |
         Add Assemblies...</em> menu option or as part of an already created MbUnit project
         using <em>File | Open Project</em>. If you add the wrong test assembly, remove it with <em>Assemblies | Remove Assemblies...</em><br />
         <a href="../Images/GUIRunner[2].png" target="_blank" title="Display this image at full size">
            <img src="../Images/GUIRunner[2]Thumbnail.png" alt="MbUnit GUI runner with test assembly loaded. Click this thumbnail image to show full size image" /></a><br />
         <br />
      </li>
      <li>Run all the tests using <em>Tests | Run</em> or by clicking the Run button at the
         top of the right-hand window. The GUI will highlight those tests that failed in
         red, those that passed in green, and those that were ignored in yellow. If you need to stop the test run, press the stop button on <em>Tests | Stop</em>.<br />
         <a href="../Images/GUIRunner[3].png" target="_blank" title="Display this image at full size">
            <img src="../Images/GUIRunner[3]Thumbnail.png" alt="MbUnit GUI runner with test results shown. Click this thumbnail image to show full size image" /></a><br />
         <br />
         If you want to run individual tests, first select the test from the tree on the
         left hand side, then right click the test and select <em>Tests | Start Tests</em>.
         Do the same for any subset of tests that you want to run. The test tree on the left shows the tests in an assembly divided five ways: by <a href="TestAuthorsAndCategories.htm">author, category, importance, namsepace, and the code class (type) that the tests are working on</a>.</li>
      <li>For each test that has failed, at least one exception will have occurred. To see
         the details of that exception, click on the test in question and the text of exception
         will be displayed along with its stack trace in the right hand window under the
         Exception tab (shown below). If your tests write to the command prompt or the error
         console, you can click on the test and the corresponding output will be shown in
         the Console.Out and Console.Error tabs on the right hand side of the GUI respectively.<br />
         <a href="../Images/GUIRunner[4].png" target="_blank" title="Display this image at full size">
            <img src="../Images/GUIRunner[4]Thumbnail.png" alt="MbUnit GUI runner with test exception details shown. Click this thumbnail image to show full size image" /></a><br />
         <br />
      </li>
      <li>Do a bit more coding...
         <ul>
            <li>If you write more tests to be run, compile the test assembly and reload it into
               the GUI with <em>Assemblies | Reload</em>.</li>
            <li>If you want to step through the test code as it is being executed, attach your
               debugger to the MbUnit.GUI process, set a breakpoint in the test code and run the
               test. If you want to step the code being tested, you won't need to attach your debugger
               to MbUnit.GUI. Just set the breakpoint on your code and run the test.</li></ul>
      </li>
      <li>Generate a report from the results of your last test run by choosing an option
         from the Reports menu.</li>
      <li>Save your MbUnit project for later use with <em>File | Save Project As</em>.</li>
      <li>Close the GUI or start testing a different project with either <em>File | New Project</em>
         or <em>File | Open Project</em>.</li>
   </ol>
   <h2>Context Menu Options</h2>
   <p>Selecting any node in the test tree and then right clicking it will produce a context menu with a standard set of options as follows</p>
   <ul>
      <li><em>Tests | Start Tests</em> : Runs the selected test(s)</li>
      <li><em>Tests | Stop Tests</em> : Stops the currently running test(s)</li>
      <li><em>Assemblies | Add Assemblies</em> : Lets you add a new test assembly to the current test project</li>
      <li><em>Assemblies | Remove Assemblies</em> : Lets you remove a new test assembly to the current test project</li>
      <li><em>Assemblies | Reload Assembly</em> : Tells the GUI to reload an assembly into the project</li>
      <li><em>Clear Results</em> : Clears all test results from the GUI</li>
      <li><em>Config | Load Config</em> : Loads a pre-existing MbUnit project (*.mbunit) into the GUI</li>
      <li><em>Config | Save Config As</em> : Save the current MbUnit project</li>
      <li><em>Report | *</em> : Produces and displays a report generated against the result from the last test run. The report can be in xml, text, html or dox format.</li>
      <li><em>Ncover | Run</em> : Runs the test(s) through <a href="http://ncover.org/site/" title="nCover home page">nCover</a>, a test code coverage analyser.</li>
      <li><em>Create nAnt Task (Clipboard)</em> : Generates the correct <a href="http://nant.sourceforge.net/" title="nAnt homepage">nAnt</a> command to run the whole MbUnit project and generate an HTML report. This is saved to the desktop to be added to your nAnt scripts.</li>
      <li><em>Create MSBuild Task (Clipboard)</em> : Generates the correct <a href="http://msdn2.microsoft.com/en-us/library/wea2sca5(VS.80).aspx" title="MSBuild homepage">MSBuild</a> command to run the whole MbUnit project and generate an HTML report. This is saved to the desktop to be added to your MSBuild scripts.</li>
   </ul>
   <p>Note that these last two options only produce scripts for the whole project rather than the test(s) selected.</p>
   <h2 id="cmdprompt">
      Starting the GUI Runner from the Command Prompt</h2>
   <p>
      At any point you can bring up a summary of this page by typing any of the following
      at the command prompt</p>
   <div class="cmdline">
      <pre>   MbUnit.GUI.exe /h</pre>
      <pre>   MbUnit.GUI.exe /help</pre>
   </div>
   <h2>
      Full Syntax
   </h2>
   <p>
      When starting the GUI runner from the command prompt, you can use the following
      syntax</p>
   <div class="cmdline">
      <pre>   <strong>MbUnit.GUI.exe</strong> <em>{AssemblyToTest[...]|ProjectFile}</em> 
      [[<strong>/ap:</strong><em>assemblypath</em>] 
       [<strong>/rt:</strong><em>reportType</em> [<strong>/rf:</strong><em>reportpath</em>] [<strong>/rnf:</strong><em>reportname</em>] [<strong>/tr:</strong><em>transformpath</em>] [<strong>/sr</strong>]] 
       [<strong>/fc:</strong><em>categoryName[,...]]</em>] [<strong>/ec:</strong><em>categoryName[,...]</em>] [<strong>/fa:</strong><em>authorName</em>] [/ft:className] [<strong>/fn:</strong><em>namespace</em>] 
       [<strong>/v:</strong><em>{+|-}</em>] [<strong>/sc:</strong><em>{+|-}</em>]]
       [<strong>/r</strong>] [<strong>/c</strong>]</pre>
   </div>
   <h2>
      Parameters</h2>
   <p>
      The shared codebase of GUI and console runner means that you can start the GUI runner
      in combination with <a href="MbUnitConsoleRunner.htm">any of the flags used by the
         console runner</a> plus two others covered below.
   </p>
   <ul>
      <li><strong>/r or /run</strong> : Specifies that the GUI runner should run the tests
         in the <em>AssemblyToTest</em> or <em>ProjectFile</em> as soon as it has loaded
         without prompt from the user.</li>
      <li><strong>/c or /close</strong> : Specified that the GUI runner should close once
         tests have been run (with /r). Specifying /c without /r will just close the GUI
         before anything can be done.</li>
   </ul>
   <h2>
      Notes</h2>
   <p>
      It should be pointed out that <strong>/fc, /ec, /fa, /ft, /fn and /v</strong> have
      no effect on how the GUI runs.</p>
   <h2>
      Examples</h2>
   <p>
      To open the GUI runner and load a test assembly into it</p>
   <div class="cmdline">
      <pre>   <strong>MbUnit.GUI.exe TestAssembly.dll</strong></pre>
   </div>
   <p>
      To open the GUI runner, load a test assembly, run it and generate a HTML report
      for the tests</p>
   <div class="cmdline">
      <pre>   <strong>MbUnit.GUI.exe TestAssembly.dll /rt:html /r</strong></pre>
   </div>
   <p>
      To open the GUI runner, load a test assembly, run it, generate a HTML report, and
      close the gui afterwards</p>
   <div class="cmdline">
      <pre>   <strong>MbUnit.GUI.exe TestAssembly.dll /rt:html /r /c</strong></pre>
   </div>
</body>
</html>
